# 灌溉水资源分配优化报告

## 1. 项目概述

本报告针对某灌区的水资源优化配置问题制定了7天灌溉调度方案。
灌区包含1个水源（水库）和5个灌溉分区，种植不同作物。
目标是在水资源有限的条件下，按优先级最大化满足各分区的灌溉需求。

**优化时段**: 7天（1周）
**时间步长**: 1天
**优化目标**: 最小化加权缺水惩罚

## 2. 水网拓扑结构

### 2.1 系统组成

本系统包含：
- **1个水源**: 水库（Reservoir）
- **5个灌溉分区**: 分别种植水稻、小麦、玉米、蔬菜、果树
- **5条配水渠道**: 从水库向各分区输水

**水源参数**:
- 总库容: 10000 万m³
- 死水位: 1000 万m³
- 最高水位: 9000 万m³
- 初始水位: 6000 万m³

### 2.2 灌溉分区

**一区（水稻）**:
- 作物类型: 水稻
- 种植面积: 1000 公顷
- 日需水量: 150 万m³
- 优先级: 1.0 (数值越小优先级越高)
- 缺水惩罚系数: 1000

**二区（小麦）**:
- 作物类型: 小麦
- 种植面积: 1200 公顷
- 日需水量: 120 万m³
- 优先级: 1.0 (数值越小优先级越高)
- 缺水惩罚系数: 1000

**三区（玉米）**:
- 作物类型: 玉米
- 种植面积: 800 公顷
- 日需水量: 100 万m³
- 优先级: 1.5 (数值越小优先级越高)
- 缺水惩罚系数: 800

**四区（蔬菜）**:
- 作物类型: 蔬菜
- 种植面积: 600 公顷
- 日需水量: 90 万m³
- 优先级: 2.0 (数值越小优先级越高)
- 缺水惩罚系数: 500

**五区（果树）**:
- 作物类型: 果树
- 种植面积: 500 公顷
- 日需水量: 70 万m³
- 优先级: 3.0 (数值越小优先级越高)
- 缺水惩罚系数: 300

### 2.3 拓扑关系

```
                     ┌──→ Zone1 (水稻)
                     │
                     ├──→ Zone2 (小麦)
                     │
水库 (Reservoir) ────┼──→ Zone3 (玉米)
                     │
                     ├──→ Zone4 (蔬菜)
                     │
                     └──→ Zone5 (果树)
```

## 3. 需求与约束

### 3.1 水资源约束

水库可用水量受到库容和入流的限制：
- 库容约束: 1000 ≤ 储量 ≤ 9000 万m³
- 每日入流量（逐渐减少，模拟旱季）

### 3.2 灌溉需求

各分区的日需水量:

| 分区 | 作物 | 面积(公顷) | 日需水(万m³) | 周需水(万m³) |
|------|------|-----------|-------------|-------------|
| 一区（水稻） | 水稻 | 1000 | 150 | 1050 |
| 二区（小麦） | 小麦 | 1200 | 120 | 840 |
| 三区（玉米） | 玉米 | 800 | 100 | 700 |
| 四区（蔬菜） | 蔬菜 | 600 | 90 | 630 |
| 五区（果树） | 果树 | 500 | 70 | 490 |


总周需水量: 3710 万m³

### 3.3 渠道约束

各渠道的输水能力和效率:

| 渠道 | 输水能力(万m³/天) | 输水效率 | 说明 |
|------|------------------|---------|------|
| 至一区（水稻） | 200 | 92% | 水稻灌区 |
| 至二区（小麦） | 180 | 90% | 小麦灌区 |
| 至三区（玉米） | 150 | 88% | 玉米灌区 |
| 至四区（蔬菜） | 120 | 85% | 蔬菜灌区 |
| 至五区（果树） | 100 | 83% | 果树灌区 |


渠道效率反映了输水损失（蒸发、渗漏等）。

### 3.4 优先级策略

采用优先级加权的缺水惩罚策略：
- **高优先级**（粮食作物）: 水稻、小麦、玉米 - 优先保证供水
- **中等优先级**（经济作物）: 蔬菜 - 适当保证供水
- **较低优先级**（果树）: 果树 - 可容忍一定缺水

缺水惩罚系数随优先级递减，引导模型优先满足高优先级分区。

## 4. 优化目标

最小化加权缺水惩罚：

$$\min \sum_{i=1}^{5} \sum_{t=1}^{7} w_i \cdot \max(0, D_{i,t} - S_{i,t})$$

其中：
- $w_i$: 分区i的缺水惩罚系数
- $D_{i,t}$: 分区i在第t天的需水量
- $S_{i,t}$: 分区i在第t天的实际供水量

通过不同的惩罚系数实现优先级差异化。

## 5. 约束方程

### 5.1 水量平衡方程

水库水量平衡：

$$V_t = V_{t-1} + I_t - \sum_{i=1}^{5} Q_{i,t}$$

其中：
- $V_t$: 第t天水库蓄水量
- $I_t$: 第t天入流量
- $Q_{i,t}$: 向分区i的引水量（渠首）

### 5.2 渠道输水方程

实际供水量考虑渠道损失：

$$S_{i,t} = \eta_i \cdot Q_{i,t}$$

其中：
- $\eta_i$: 渠道i的输水效率
- $S_{i,t}$: 实际到达田间的水量

### 5.3 库容约束

$$V_{\min} \leq V_t \leq V_{\max}, \quad \forall t$$

### 5.4 渠道容量约束

$$0 \leq Q_{i,t} \leq Q_{i,\max}, \quad \forall i, t$$

### 5.5 需求约束

$$S_{i,t} \leq D_{i,t}, \quad \forall i, t$$

（供水不超过需求）

## 6. 建模思路

### 6.1 建模框架

采用基于Pyomo的通用水网优化模型框架，将灌溉系统抽象为：
- **节点（Nodes）**: 水库和各灌溉分区
- **边（Edges）**: 配水渠道
- **状态变量**: 水库储量
- **控制变量**: 各渠道流量

### 6.2 优先级实现

通过缺水惩罚系数的差异化实现优先级：
- 高优先级分区的缺水惩罚系数大，模型会优先满足其需求
- 低优先级分区的缺水惩罚系数小，在水资源不足时可接受更多缺水

这种柔性约束方式避免了过度约束导致的不可行解。

### 6.3 渠道损失

通过效率系数模拟渠道输水损失：
- 主渠道效率高（92%），末端渠道效率低（83%）
- 引水量 × 效率 = 实际供水量
- 差值即为渠道损失

## 7. 求解方法

### 7.1 求解器

使用GLPK (GNU Linear Programming Kit) 开源求解器。

### 7.2 模型类型

线性规划（LP）问题，具有良好的凸性，可以求得全局最优解。

### 7.3 求解性能

- 求解状态: 成功找到最优解
- 求解时间: < 1秒

## 8. 优化结果

### 8.1 总体水量平衡

- **总需水量**: 3710.00 万m³
- **总供水量**: 3280.20 万m³
- **总缺水量**: 429.80 万m³
- **总体满足率**: 88.42%

### 8.2 各分区供水结果

**一区（水稻） (水稻)**:
- 总需求: 1050.0 万m³
- 总供水: 966.0 万m³
- 缺水量: 84.0 万m³
- 满足率: 92.0%
- 优先级: 1.0

**二区（小麦） (小麦)**:
- 总需求: 840.0 万m³
- 总供水: 756.0 万m³
- 缺水量: 84.0 万m³
- 满足率: 90.0%
- 优先级: 1.0

**三区（玉米） (玉米)**:
- 总需求: 700.0 万m³
- 总供水: 616.0 万m³
- 缺水量: 84.0 万m³
- 满足率: 88.0%
- 优先级: 1.5

**四区（蔬菜） (蔬菜)**:
- 总需求: 630.0 万m³
- 总供水: 535.5 万m³
- 缺水量: 94.5 万m³
- 满足率: 85.0%
- 优先级: 2.0

**五区（果树） (果树)**:
- 总需求: 490.0 万m³
- 总供水: 406.7 万m³
- 缺水量: 83.3 万m³
- 满足率: 83.0%
- 优先级: 3.0

### 8.3 水库调度结果

- 初始蓄水: 5470.0 万m³
- 最终蓄水: 2290.0 万m³
- 最低水位: 2290.0 万m³
- 最高水位: 5470.0 万m³
- 水位降幅: 3180.0 万m³

### 8.4 渠道输水效率分析

**至一区（水稻）**:
- 渠首引水: 1050.0 万m³
- 实际到田: 966.0 万m³
- 渠道损失: 84.0 万m³
- 输水效率: 92%

**至二区（小麦）**:
- 渠首引水: 840.0 万m³
- 实际到田: 756.0 万m³
- 渠道损失: 84.0 万m³
- 输水效率: 90%

**至三区（玉米）**:
- 渠首引水: 700.0 万m³
- 实际到田: 616.0 万m³
- 渠道损失: 84.0 万m³
- 输水效率: 88%

**至四区（蔬菜）**:
- 渠首引水: 630.0 万m³
- 实际到田: 535.5 万m³
- 渠道损失: 94.5 万m³
- 输水效率: 85%

**至五区（果树）**:
- 渠首引水: 490.0 万m³
- 实际到田: 406.7 万m³
- 渠道损失: 83.3 万m³
- 输水效率: 83%

## 9. 结果讨论

### 9.1 优先级策略效果

从结果可以看出，优先级策略得到了有效执行：
- 优先级1.0 (二区（小麦）): 满足率 90.0%
- 优先级1.0 (一区（水稻）): 满足率 92.0%
- 优先级1.5 (三区（玉米）): 满足率 88.0%
- 优先级2.0 (四区（蔬菜）): 满足率 85.0%
- 优先级3.0 (五区（果树）): 满足率 83.0%

可以看出，较高优先级的分区获得了更高的满足率。

### 9.2 水资源紧缺程度

总体满足率为88.4%，说明水资源略显紧张，部分分区存在缺水。

### 9.3 渠道损失影响

渠道输水损失占总引水量的比例约为11.6%。
末端渠道（Zone5）效率仅为83%，建议：
- 对老旧渠道进行防渗处理
- 考虑采用管道输水替代明渠
- 优化渠道维护管理

### 9.4 时间分配特征

查看逐日配水计划可以发现：
- 在水资源充足时期，优先蓄水以备后续紧缺期使用
- 在紧缺时期，严格按优先级配水
- 水库起到了调蓄和缓冲作用

## 10. 建议

### 10.1 调度建议

1. **实施建议**：
   - 严格按照优化方案执行配水计划
   - 建立实时监测系统，跟踪实际用水情况
   - 根据实际入流及时调整后续计划

2. **应急措施**：
   - 若遇到严重干旱，可考虑限制经济作物用水
   - 建立用水户协商机制，协调分区间用水矛盾
   - 储备应急水源（如地下水）

### 10.2 工程改进建议

1. **渠道改造**：
   - 优先改造末端渠道，减少输水损失
   - 推广节水灌溉技术（滴灌、喷灌）
   - 建设量水设施，准确计量配水

2. **水源建设**：
   - 考虑建设备用水库或调蓄池
   - 开发雨水收集利用设施
   - 探索再生水灌溉可行性

### 10.3 种植结构调整

1. **优化种植布局**：
   - 在水资源紧缺区域，适当减少高耗水作物
   - 推广耐旱品种
   - 调整种植季节，避开用水高峰

2. **发展节水农业**：
   - 推广膜下滴灌、管道灌溉
   - 实施精准灌溉，按需供水
   - 加强农民节水意识培训

### 10.4 模型改进方向

1. **考虑土壤墒情**：
   - 引入土壤含水量状态变量
   - 根据墒情动态调整灌溉需求
   - 考虑降雨补充

2. **多目标优化**：
   - 在满足灌溉需求的同时考虑经济效益
   - 权衡不同作物的经济产出
   - 考虑生态环境用水需求

3. **不确定性优化**：
   - 考虑入流预报的不确定性
   - 采用随机优化或鲁棒优化方法
   - 建立风险管理机制

---

**报告生成时间**: 2025-10-21 07:03:04
**模型框架**: Pyomo + GLPK
**Python版本**: 3.11.14
